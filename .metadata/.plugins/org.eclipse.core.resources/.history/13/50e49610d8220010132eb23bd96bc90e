package com.novelsbr.backend.repositories;

import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;

import com.novelsbr.backend.domain.entities.Novel;
import com.novelsbr.backend.domain.projections.AuthorNovelMinProjection;
import com.novelsbr.backend.domain.projections.CardNovelProjection;

public interface NovelRepository extends JpaRepository<Novel, Long> {

	@Query(value = """
			SELECT n.id AS novel_id, a.id AS author_id, n.novel_name, a.username, n.image_uri 
			FROM TBL_NOVEL AS n 
			INNER JOIN TBL_AUTHOR AS a ON a.id = n.author_id 
			LIMIT 4
			""", nativeQuery = true)
	List<CardNovelProjection> findNovelCards();
	
	@Query(value = """
			SELECT n.id AS novel_id, a.id AS author_id, n.novel_name, a.username, n.image_uri, n.synopsis 
			FROM TBL_NOVEL AS n 
			INNER JOIN TBL_AUTHOR AS a ON a.id = n.author_id 
			WHERE n.id = :novelId	
			""", nativeQuery = true)
	AuthorNovelMinProjection findNovelInfoByNovelId(Long novelId);
}
